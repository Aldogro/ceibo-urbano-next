_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[22],{RGGt:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/promos",function(){return t("XKQv")}])},XKQv:function(e,r,t){"use strict";t.r(r);var n=t("cpVT"),c=t("nKUr"),a=t("vJKn"),o=t.n(a),i=t("rg98"),s=t("xvhg"),u=t("q1tI"),p=t.n(u),l=t("R/WZ"),d=t("2LsT"),j=t("20a2"),b=t("gVY3"),O=t("NKQG"),m=t("30+C"),f=t("lFIR"),h=t("Ie8z"),v=t("oa/T"),x=t("o4QW"),g=t("Z3vd"),w=t("PsDL"),y=t("ofer"),S=t("Ji2X"),_=t("tRbT"),T=t("HUtx"),P=t("MPUk"),E=t.n(P),k=t("xMF9"),R=t.n(k),C=t("7frF"),M=t.n(C),N=t("CRf/"),D=t.n(N),G=t("g009"),I=t("5Mca");r.default=function(){var e=U(),r=Object(d.b)(),t=Object(s.a)(r,2),n=t[0],a=(t[1],Object(b.c)()),l=Object(s.a)(a,2),P=l[0],k=l[1],C=Object(u.useState)(!1),N=C[0],X=C[1],z=Object(u.useState)(null),B=z[0],K=z[1],q=Object(j.useRouter)(),A=Object(O.b)(),F=A.enqueueSnackbar;A.closeSnackbar;Object(u.useEffect)((function(){n.user.email||q.push("/login"),H()}),[]);var H=function(){var e=Object(i.a)(o.a.mark((function e(){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(I.f)("promos");case 3:r=e.sent,k({type:b.a.SET_PROMOS,payload:r.docs.map((function(e){return e.data()}))}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),F("Ha sucedido un error al obtener las promos",{variant:"error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(i.a)(o.a.mark((function e(r){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.id,n=r.publish,e.prev=1,e.next=4,Object(I.h)({id:t,publish:n,collection:"promos"});case 4:F("Se actualiz\xf3 el estado correctamente",{variant:"success"}),H(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),F("Ha sucedido un error",{variant:"error"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(I.d)({selectedId:B,collection:"promos"});case 3:F("Se elimin\xf3 la promo correctamente",{variant:"success"}),X(!1),H(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),F("Ha sucedido un error",{variant:"error"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)(p.a.Fragment,{children:[Object(c.jsx)(G.a,{}),Object(c.jsx)(S.a,{maxWidth:"lg",className:e.marginTop,children:n.user.email?Object(c.jsxs)("div",{className:e.root,children:[Object(c.jsx)(y.a,{className:e.title,variant:"h4",children:"Listado de promos"}),Object(c.jsx)(g.a,{color:"primary",className:e.addButton,onClick:function(){return q.push("/promos/add")},children:"Agregar Promo"}),Object(c.jsx)(T.a,{isOpen:N,handleConfirm:function(){return L()},handleClose:function(){return X(!1)},question:"\xbfSeguro quer\xe9s borrar esta promo?"}),Object(c.jsx)(_.a,{container:!0,spacing:2,children:null===P||void 0===P?void 0:P.promos.map((function(r){return Object(c.jsx)(_.a,{item:!0,xs:12,lg:+r.cols,children:Object(c.jsxs)(m.a,{children:[Object(c.jsxs)(f.a,{children:[Object(c.jsx)(h.a,{className:e.media,image:r.picture,title:r.name}),Object(c.jsxs)(v.a,{children:[Object(c.jsx)(y.a,{gutterBottom:!0,variant:"h5",component:"h2",children:r.name}),Object(c.jsx)(y.a,{variant:"body2",color:"textSecondary",component:"p",children:r.description})]})]}),Object(c.jsxs)(x.a,{children:[Object(c.jsx)(w.a,{size:"small",color:"primary",onClick:function(){return q.push("/promos/".concat(r.id,"/edit"))},children:Object(c.jsx)(E.a,{})}),Object(c.jsx)(w.a,{size:"small",color:"primary",onClick:function(){return e=r.id,X(!0),void K(e);var e},children:Object(c.jsx)(R.a,{})}),Object(c.jsx)(w.a,{size:"small",color:"primary",onClick:function(){return J(r)},children:r.publish?Object(c.jsx)(M.a,{}):Object(c.jsx)(D.a,{})})]})]})},r.id)}))})]}):Object(c.jsx)("div",{})})]})};var U=Object(l.a)((function(e){return{root:{overflow:"hidden",backgroundColor:e.palette.background.paper},marginTop:{margin:e.spacing("70px","auto")},addButton:{marginBottom:"2rem"},gridList:{width:1200,height:"auto"},media:{height:140},icon:{color:"rgba(255, 255, 255, 0.54)"},title:Object(n.a)({marginTop:"1rem",marginBottom:"1rem",fontSize:"18px"},e.breakpoints.up("sm"),{marginTop:"2rem",marginBottom:"1rem",fontSize:"24px"})}}))},gVY3:function(e,r,t){"use strict";t.d(r,"a",(function(){return l})),t.d(r,"b",(function(){return j})),t.d(r,"c",(function(){return b}));var n=t("nKUr"),c=t("cpVT"),a=t("q1tI"),o=t.n(a);t("5Mca");function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){Object(c.a)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var u=o.a.createContext({}),p={promo:{},promos:[],maxDiscount:0},l={SET_PROMO:"SET_PROMO",SET_PROMOS:"SET_PROMOS",GET_MAX_DISCOUNT:"GET_MAX_DISCOUNT"},d=function(e,r){switch(r.type){case l.SET_PROMO:return s(s({},e),{},{promo:r.payload});case l.SET_PROMOS:return s(s({},e),{},{promos:r.payload||[]});case l.GET_MAX_DISCOUNT:var t=0;return e.promos.forEach((function(e){e.discount<t&&(t=e.discount)})),s(s({},e),{},{maxDiscount:-1*t});default:throw new Error("Unhandled action type: ".concat(r.type))}},j=function(e){var r=e.children,t=Object(a.useReducer)(d,p),c=t[0],o=t[1];return Object(n.jsx)(u.Provider,{value:[c,o],children:r})},b=function(){return Object(a.useContext)(u)}}},[["RGGt",1,2,4,5,0,3,7,6,8,12]]]);