_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[21],{Iljs:function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return O}));var r=n("nKUr"),c=n("cpVT"),a=n("q1tI"),o=n.n(a),i=n("j7uD");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=o.a.createContext({}),d={promo:{},promos:[]},j={CREATE_PROMO:"CREATE_PROMO",SET_PROMO:"SET_PROMO",SET_PROMOS:"SET_PROMOS"},b=function(e,t){switch(t.type){case j.CREATE_PROMO:var n=(new Date).getTime().toString();return void i.b.firestore().collection("promos").doc(n).set(u(u({},t.payload),{},{id:n})).then((function(){return console.log("promo agregada")})).catch((function(e){return console.log("error al agregar una promo")}));case j.SET_PROMO:return u(u({},e),{},{promo:t.payload});case j.SET_PROMOS:return u(u({},e),{},{promos:t.payload||[]});default:throw new Error("Unhandled action type: ".concat(t.type))}},m=function(e){var t=e.children,n=Object(a.useReducer)(b,d),c=n[0],o=n[1];return Object(r.jsx)(l.Provider,{value:[c,o],children:t})},O=function(){return Object(a.useContext)(l)}},jgTA:function(e,t,n){"use strict";var r=n("nKUr"),c=n("q1tI"),a=n.n(c),o=n("R/WZ"),i=n("20a2"),s=n("Z3vd"),u=n("tRbT"),l=n("r9w1"),d=n("UhlP"),j=n("ZGBi"),b=n("LnxZ"),m=n("PsDL"),O=n("ytJY"),f=n.n(O),p=n("j7uD");t.a=function(e){var t=e.promo,n=void 0===t?{}:t,o=e.onSubmit,O=Object(c.useState)(""),g=O[0],x=O[1],v=Object(c.useState)(""),y=v[0],P=v[1],w=Object(c.useState)(""),N=w[0],S=w[1],E=Object(c.useState)(""),R=E[0],_=E[1],C=Object(c.useState)(""),T=C[0],D=C[1],k=Object(c.useState)(!1),M=k[0],W=k[1],q=Object(c.useState)([]),U=q[0],A=q[1],I=Object(i.useRouter)(),L=function(e){e.preventDefault(),o({name:g,price:y,cols:N,discount:R,picture:T,publish:M,products:U})};Object(c.useEffect)((function(){0!==Object.keys(n).length&&(x(n.name),P(n.price),S(n.cols),_(n.discount),D(n.picture),W(n.publish),A(n.products))}),[n]);var Z=h(),F=function(){var e=0;U.forEach((function(t){e+=t.price})),P(Math.ceil(e-R*e/100))};return Object(r.jsx)(a.a.Fragment,{children:Object(r.jsxs)("form",{className:Z.root,onSubmit:function(e){return L(e)},noValidate:!0,autoComplete:"off",children:[Object(r.jsxs)(u.a,{container:!0,spacing:3,cols:1,children:[Object(r.jsx)(u.a,{item:!0,xs:12,lg:12,children:Object(r.jsx)(j.a,{control:Object(r.jsx)(d.a,{checked:M,onChange:function(e){var t=e.target;return W(t.checked)},color:"primary"}),label:"Publicar"})}),Object(r.jsx)(u.a,{item:!0,xs:12,md:8,children:Object(r.jsx)(l.a,{className:Z.fullWidth,id:"Name",label:"Nombre",value:g,required:!0,onChange:function(e){var t=e.target;return x(t.value)}})}),Object(r.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(r.jsx)(l.a,{className:Z.fullWidth,id:"cols",label:"Columnas",type:"number",value:N,onChange:function(e){var t=e.target;return S(t.value)}})}),Object(r.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(r.jsx)(l.a,{className:Z.fullWidth,id:"discount",label:"Descuento %",type:"number",value:R,onChange:function(e){var t=e.target;_(t.value),F()}})}),Object(r.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(r.jsx)(l.a,{className:Z.fullWidth,id:"Price",label:"$".concat(y," - autom\xe1tico"),disabled:!0,type:"number"})}),Object(r.jsxs)(u.a,{item:!0,xs:12,md:12,className:Z.products,children:[U.map((function(e,t){return Object(r.jsxs)(u.a,{container:!0,spacing:3,cols:1,children:[Object(r.jsx)(u.a,{item:!0,xs:12,md:7,children:Object(r.jsx)(l.a,{className:Z.fullWidth,id:"Name",label:e.name||"Nombre",required:!0,onChange:function(e){return function(e,t){var n=U;n[t].name=e.value,A(n)}(e.target,t)}})}),Object(r.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(r.jsx)(l.a,{className:Z.fullWidth,id:"Price",label:e.price||"Precio $",type:"number",onChange:function(e){return function(e,t){var n=U;n[t].price=+e.value,A(n),F()}(e.target,t)}})}),Object(r.jsx)(u.a,{item:!0,xs:12,md:1,children:Object(r.jsx)(m.a,{onClick:function(){return function(e){A(U.filter((function(t){return t!==e})))}(e)},children:Object(r.jsx)(f.a,{})})})]},t)})),Object(r.jsx)(s.a,{onClick:function(){A(U.concat([{name:"Nombre",price:0}]))},children:"Agregar Producto"})]}),Object(r.jsx)(u.a,{item:!0,xs:12,md:6,children:Object(r.jsx)(b.a,{acceptedFiles:["image/*"],filesLimit:1,onChange:function(e){return function(e){e.length&&p.b.storage().ref().child("/images").child(e[0].name).put(e[0]).then((function(e){return p.b.storage().ref(e.metadata.fullPath).getDownloadURL()})).then((function(e){return D(e)}))}(e)},onDelete:function(){return D("")}})}),T?Object(r.jsx)(u.a,{item:!0,xs:6,children:Object(r.jsx)("div",{className:Z.contain,children:Object(r.jsx)("img",{className:Z.fullWidth,src:T,alt:"promo image"})})}):Object(r.jsx)("div",{})]}),Object(r.jsxs)(u.a,{item:!0,xs:12,className:Z.actions,children:[Object(r.jsx)(s.a,{className:Z.floatRight,variant:"contained",type:"submit",color:"primary",children:"Guardar"}),Object(r.jsx)(s.a,{className:Z.floatRight,variant:"contained",color:"secondary",onClick:function(){return I.push("/promos")},children:"Cancelar"})]})]})})};var h=Object(o.a)((function(e){return{actions:{margin:e.spacing("20px",0)},contain:{maxHeight:"250px",width:"100%",display:"flex"},fullWidth:{width:"100%",maxHeigth:"100%",objectFit:"contain"},floatRight:{minWidth:120,float:"right",marginLeft:16}}}))},mwgd:function(e,t,n){"use strict";n.r(t);var r=n("nKUr"),c=n("xvhg"),a=n("q1tI"),o=n.n(a),i=n("20a2"),s=n("Iljs"),u=n("R/WZ"),l=n("NKQG"),d=n("p7UQ"),j=n("jgTA"),b=n("Ji2X"),m=n("ofer"),O=n("j7uD");t.default=function(){var e=Object(s.c)(),t=Object(c.a)(e,2),n=t[0],u=t[1],p=f(),h=Object(i.useRouter)(),g=Object(l.b)(),x=g.enqueueSnackbar;g.closeSnackbar;Object(a.useEffect)((function(){var e=h.query.id;h.query.id&&v(e)}),[h.query]);var v=function(e){Object(O.f)({collection:"promos",id:e}).then((function(e){u({type:s.a.SET_PROMO,payload:e.data()})}))};return Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(d.a,{}),Object(r.jsxs)(b.a,{className:p.container,children:[Object(r.jsx)(m.a,{className:p.title,variant:"h4",children:"Editar Promos"}),null!==n&&void 0!==n&&n.promo?Object(r.jsx)(j.a,{onSubmit:function(e){return function(e){Object(O.d)({collection:"promos",id:h.query.id,data:e}).then((function(){x("Se ha editado la promo correctamente",{variant:"success"}),h.push("/promos")})).catch((function(e){return x("Ha ocurrido un error",{variant:"error"})}))}(e)},promo:n.promo}):null]})]})};var f=Object(u.a)((function(e){return{container:{margin:e.spacing("70px","auto")},title:{marginTop:"2rem",marginBottom:"2rem"}}}))},sUPp:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/promos/[id]/edit",function(){return n("mwgd")}])}},[["sUPp",1,2,4,5,0,3,7,6,8,9,10]]]);