_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[22],{"0O4B":function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/promos/add",function(){return a("wlUP")}])},jgTA:function(e,t,a){"use strict";var n=a("cpVT"),c=a("nKUr"),r=a("z7pX"),i=a("q1tI"),o=a.n(i),s=a("R/WZ"),l=a("20a2"),u=a("Z3vd"),m=a("tRbT"),d=a("r9w1"),j=a("UhlP"),b=a("ZGBi"),h=a("LnxZ"),p=a("PsDL"),f=a("ytJY"),g=a.n(f),x=a("j7uD"),O=a("ofer");t.a=function(e){var t=e.promo,a=void 0===t?{}:t,n=e.onSubmit,s=Object(i.useState)(""),f=s[0],N=s[1],C=Object(i.useState)(0),P=C[0],S=C[1],w=Object(i.useState)(0),k=w[0],T=w[1],y=Object(i.useState)(""),W=y[0],_=y[1],I=Object(i.useState)(0),R=I[0],E=I[1],z=Object(i.useState)(""),D=z[0],F=z[1],U=Object(i.useState)(!1),B=U[0],L=U[1],q=Object(i.useState)([]),A=q[0],Z=q[1],G=Object(i.useState)([]),J=G[0],X=G[1],H=v(),K=Object(l.useRouter)(),V=function(e){e.preventDefault(),n({name:f,price:+P,partialPrice:+k,cols:W,discount:+R,picture:D,publish:B,products:A,carousel:J})};Object(i.useEffect)((function(){0!==Object.keys(a).length&&(N(a.name),S(+a.price),T(+a.partialPrice),_(+a.cols),E(+a.discount),F(a.picture),L(a.publish),Z(a.products),X(a.carousel))}),[a]),Object(i.useEffect)((function(){M()}),[P,A]);var Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.length){var a=J;e.forEach((function(e){x.b.storage().ref().child("/images").child(e.name).put(e).then((function(e){return x.b.storage().ref(e.metadata.fullPath).getDownloadURL()})).then((function(e){t?F(e):(a.push(e),X(Object(r.a)(J)))}))}))}},M=function(){var e=0;A.forEach((function(t){e+=t.price})),E(Math.ceil(100*P/e-100))};return Object(c.jsx)(o.a.Fragment,{children:Object(c.jsxs)("form",{className:H.root,onSubmit:function(e){return V(e)},noValidate:!0,autoComplete:"off",children:[Object(c.jsxs)(m.a,{container:!0,spacing:3,cols:1,children:[Object(c.jsx)(m.a,{item:!0,xs:12,lg:12,children:Object(c.jsx)(b.a,{control:Object(c.jsx)(j.a,{checked:B,onChange:function(e){var t=e.target;return L(t.checked)},color:"primary"}),label:"Publicar"})}),Object(c.jsx)(m.a,{item:!0,xs:12,md:8,children:Object(c.jsx)(d.a,{className:H.fullWidth,id:"Name",label:"Nombre",value:f,required:!0,onChange:function(e){var t=e.target;return N(t.value)}})}),Object(c.jsx)(m.a,{item:!0,xs:12,md:4,children:Object(c.jsx)(d.a,{className:H.fullWidth,id:"cols",label:"Columnas",type:"number",value:W,onChange:function(e){var t=e.target;return _(t.value)}})}),Object(c.jsx)(m.a,{item:!0,xs:12,md:4,children:Object(c.jsx)(d.a,{className:H.fullWidth,id:"discount",label:"".concat(R||"Descuento"," % - Autom\xe1tico"),disabled:!0})}),Object(c.jsx)(m.a,{item:!0,xs:12,md:4,children:Object(c.jsx)(d.a,{className:H.fullWidth,id:"Price",label:"Precio",value:P,type:"number",onChange:function(e){var t=e.target;return S(+t.value)}})}),Object(c.jsxs)(m.a,{item:!0,xs:12,md:12,className:H.products,children:[Object(c.jsx)(O.a,{children:"Productos"}),A.map((function(e,t){return Object(c.jsxs)(m.a,{className:H.productContainer,container:!0,spacing:1,cols:1,children:[Object(c.jsx)(m.a,{item:!0,xs:12,md:7,children:Object(c.jsx)(d.a,{className:H.fullWidth,id:"Name",label:e.name||"Nombre",required:!0,onChange:function(e){return function(e,t){var a=A;a[t].name=e.value,Z(a)}(e.target,t)}})}),Object(c.jsx)(m.a,{item:!0,xs:12,md:4,children:Object(c.jsx)(d.a,{className:H.fullWidth,id:"Price",label:e.price||"Precio $",type:"number",onChange:function(e){return function(e,t){var a=A;a[t].price=+e.value,Z(a),M()}(e.target,t)}})}),Object(c.jsx)(m.a,{item:!0,xs:12,md:1,children:Object(c.jsx)(p.a,{className:H.removeProduct,onClick:function(){return function(e){Z(A.filter((function(t){return t!==e})))}(e)},children:Object(c.jsx)(g.a,{})})})]},t)})),Object(c.jsx)(u.a,{className:H.addProduct,color:"primary",onClick:function(){Z(A.concat([{name:"Nombre",price:0}]))},children:"Agregar Producto"})]}),Object(c.jsx)(m.a,{item:!0,xs:12,md:6,children:Object(c.jsx)(h.a,{acceptedFiles:["image/*"],filesLimit:1,maxFileSize:1e7,dropzoneText:"Imagen principal",onChange:function(e){return Q(e,!0)},onDelete:function(){return F("")}})}),D?Object(c.jsx)(m.a,{item:!0,xs:6,children:Object(c.jsx)("div",{className:H.contain,children:Object(c.jsx)("img",{className:H.fullWidth,src:D,alt:"promo image"})})}):Object(c.jsx)("div",{}),Object(c.jsx)(m.a,{item:!0,xs:12,md:12,children:Object(c.jsx)(h.a,{acceptedFiles:["image/*"],filesLimit:10,maxFileSize:1e7,dropzoneText:"Im\xe1genes para el carrusel",onChange:function(e){return Q(e)}})}),Object(c.jsxs)(m.a,{item:!0,xs:12,md:12,children:[Object(c.jsx)(O.a,{children:"Im\xe1genes del carrusel"}),J?J.map((function(e){return Object(c.jsxs)("div",{className:H.carouselImageContainer,children:[Object(c.jsx)(p.a,{className:H.removeCarouselImage,onClick:function(){return function(e){X(J.filter((function(t){return t!==e})))}(e)},children:Object(c.jsx)(g.a,{})}),Object(c.jsx)("img",{className:H.carouselImage,src:e})]},e)})):null]})]}),Object(c.jsxs)(m.a,{item:!0,xs:12,className:H.actions,children:[Object(c.jsx)(u.a,{className:H.floatRight,variant:"contained",type:"submit",color:"primary",children:"Guardar"}),Object(c.jsx)(u.a,{className:H.floatRight,variant:"contained",color:"secondary",onClick:function(){return K.push("/promos")},children:"Cancelar"})]})]})})};var v=Object(s.a)((function(e){return{actions:{margin:e.spacing("20px",0)},contain:{maxHeight:"250px",width:"100%",display:"flex"},fullWidth:{width:"100%",maxHeigth:"100%",objectFit:"contain"},floatRight:{minWidth:120,float:"right",marginLeft:16},productContainer:{padding:e.spacing(0,2),"&:nth-child(even)":{background:e.palette.lightGreen.main}},addProduct:{marginTop:e.spacing(2),float:"right"},removeProduct:Object(n.a)({color:e.palette.error.light,float:"right",paddingRight:0},e.breakpoints.up("sm"),{paddingRight:1}),carouselImageContainer:{height:"100px",display:"inline-block",position:"relative"},carouselImage:{padding:e.spacing(2),height:"100px"},removeCarouselImage:{color:e.palette.error.main,position:"absolute",top:5,right:5}}}))},wlUP:function(e,t,a){"use strict";a.r(t);var n=a("cpVT"),c=a("nKUr"),r=a("q1tI"),i=a.n(r),o=a("20a2"),s=a("R/WZ"),l=a("NKQG"),u=a("p7UQ"),m=a("Ji2X"),d=a("ofer"),j=a("jgTA"),b=a("j7uD");t.default=function(){var e=Object(o.useRouter)(),t=h(),a=Object(l.b)(),n=a.enqueueSnackbar;a.closeSnackbar;return Object(c.jsxs)(i.a.Fragment,{children:[Object(c.jsx)(u.a,{}),Object(c.jsxs)(m.a,{maxWidth:"lg",className:t.root,children:[Object(c.jsx)(d.a,{className:t.title,variant:"h4",children:"Agregar Promo"}),Object(c.jsx)(j.a,{onSubmit:function(t){return function(t){Object(b.a)({collection:"promos",data:t}).then((function(){n("Se ha creado la promo correctamente",{variant:"success"}),e.push("/promos")})).catch((function(e){return n("Ha ocurrido un error",{variant:"error"})}))}(t)}})]})]})};var h=Object(s.a)((function(e){return{root:{marginTop:"70px",marginBottom:"90px"},title:Object(n.a)({marginTop:"1rem",marginBottom:"1rem",fontSize:"18px"},e.breakpoints.up("sm"),{marginTop:"2rem",marginBottom:"1rem",fontSize:"24px"})}}))}},[["0O4B",1,2,4,5,0,3,7,6,8,9,10]]]);